"use strict";(function(){var urlSearch=window.location.search.substr(1).split('&');var appDom=document.querySelector('#app');var url='https://smartsignature.io';var baseUrl='https://api.smartsignature.io';var logoImg='../img/logo.png';var urlSearchData={};var axiosApi=axios.create({baseURL:baseUrl,timeout:30000});var regRemoveContent=function regRemoveContent(str){var strTrim=function strTrim(str){return str.replace(/\s+/g,'')};var regRemoveTag=function regRemoveTag(str){return str.replace(/<[^>]+>/ig,'')};var regRemoveMarkdownImg=function regRemoveMarkdownImg(str){return str.replace(/!\[.*?\]\((.*?)\)/ig,'')};var regRemoveMarkdownTag=function regRemoveMarkdownTag(str){return str.replace(/[\\\`\*\_\[\]\#\+\-\!\>]/ig,'')};var regRemoveTagResult=regRemoveTag(str);var regRemoveMarkdownImgResult=regRemoveMarkdownImg(regRemoveTagResult);var regRemoveMarkdownTagResult=regRemoveMarkdownTag(regRemoveMarkdownImgResult);return strTrim(regRemoveMarkdownTagResult)};var urlSearchDecodeURIComponent=function urlSearchDecodeURIComponent(arr){var data={};arr.forEach(function(i){var arrData=i.split('=');data[arrData[0]]=decodeURIComponent(arrData[1])});return data};urlSearchData=urlSearchDecodeURIComponent(urlSearch);if(urlSearchData.content)urlSearchData.content=regRemoveContent(urlSearchData.content);var setAppDom=function setAppDom(_ref){var title=_ref.title,content=_ref.content,img=_ref.img,ups=_ref.ups,read=_ref.read,username=_ref.username;var appDomStr="\n      <div class=\"container\">\n        <div class=\"widget\">\n          <img class=\"logo\" src=\"".concat(logoImg,"\" alt=\"logo\" />\n          <h1 class=\"jumpPage\">").concat(title||'没有获取到标题......',"</h1>\n          <div class=\"widget-content\">\n            <img class=\"cover jumpPage\" src=\"").concat(img||logoImg,"\" alt=\"cover\" />\n            <p class=\"widget-des\">").concat(content||'没有获取到内容......',"</p>\n          </div>\n          <p class=\"author\">by: ").concat(username||'没有获取到作者信息...',"</p>\n          <div class=\"readorups jumpPage\">\n            <span><img src=\"./img/read.svg\" alt=\"read\" />").concat(read||0,"</span>\n            <span><img src=\"./img/ups.svg\" alt=\"ups\" />").concat(ups||0,"</span>\n          </di>\n        </div>\n      </div>");appDom.innerHTML=appDomStr;$clamp(document.querySelector('.widget-des'),{clamp:3});var titleClick=function titleClick(){var jumpPageDom=document.querySelectorAll('.jumpPage');jumpPageDom.forEach(function(i,index){jumpPageDom[index].addEventListener('click',function(){var invite=urlSearchData.invite?"?invite=".concat(urlSearchData.invite):'';window.open("".concat(url,"/article/").concat(urlSearchData.id||'').concat(invite))},false)})};titleClick()};var getArticleContent=function getArticleContent(hash){var url="/ipfs/catJSON/".concat(hash);axiosApi.get(url).then(function(res){if(res.status===200&&res.data.code===200){var data=res.data.data;urlSearchData.content=regRemoveContent(data.content);var _urlSearchData=urlSearchData,title=_urlSearchData.title,content=_urlSearchData.content,img=_urlSearchData.img,ups=_urlSearchData.ups,read=_urlSearchData.read,username=_urlSearchData.username;setAppDom({title:title,content:content,img:img,ups:ups,read:read,username:username})}else{console.error('请求失败');setAppDom({})}}).catch(function(err){console.log(err);setAppDom({})})};var getInfobyId=function getInfobyId(id){var url="/p/".concat(id);axiosApi.get(url).then(function(response){if(response.status===200&&response.data.code===0){var data=response.data.data;urlSearchData.title=data.title;urlSearchData.ups=data.ups;urlSearchData.read=data.read;urlSearchData.username=data.nickname||data.username;urlSearchData.img=data.cover?"".concat(baseUrl,"/image/").concat(data.cover):logoImg;var _urlSearchData2=urlSearchData,title=_urlSearchData2.title,content=_urlSearchData2.content,img=_urlSearchData2.img,ups=_urlSearchData2.ups,read=_urlSearchData2.read,username=_urlSearchData2.username;setAppDom({title:title,content:content,img:img,ups:ups,read:read,username:username});if(!urlSearchData.content)getArticleContent(data.hash)}else{console.error('请求失败');setAppDom({})}}).catch(function(error){console.log(error);setAppDom({})})};getInfobyId(urlSearchData.id)})();(function(){const urlSearch=window.location.search.substr(1).split('&');const appDom=document.querySelector('#app');const url='https://test.smartsignature.io';const baseUrl='https://apitest.smartsignature.io';const logoImg='../img/logo.png';let urlSearchData={};const axiosApi=axios.create({baseURL:baseUrl,timeout:30000,});const regRemoveContent=(str)=>{const strTrim=str=>str.replace(/\s+/g,'');const regRemoveTag=str=>str.replace(/<[^>]+>/ig,'');const regRemoveMarkdownImg=str=>str.replace(/!\[.*?\]\((.*?)\)/ig,'');const regRemoveMarkdownTag=str=>str.replace(/[\\\`\*\_\[\]\#\+\-\!\>]/ig,'');const regRemoveTagResult=regRemoveTag(str);const regRemoveMarkdownImgResult=regRemoveMarkdownImg(regRemoveTagResult);const regRemoveMarkdownTagResult=regRemoveMarkdownTag(regRemoveMarkdownImgResult);return strTrim(regRemoveMarkdownTagResult)};const urlSearchDecodeURIComponent=(arr)=>{const data={};arr.forEach((i)=>{const arrData=i.split('=');data[arrData[0]]=decodeURIComponent(arrData[1])});return data};urlSearchData=urlSearchDecodeURIComponent(urlSearch);if(urlSearchData.content)urlSearchData.content=regRemoveContent(urlSearchData.content);const setAppDom=({title,content,img,ups,read,username,})=>{const appDomStr=`<div class="container"><div class="widget"><img class="logo"src="${logoImg}"alt="logo"/><h1 class="jumpPage">${title||'没有获取到标题......'}</h1><div class="widget-content"><img class="cover jumpPage"src="${img || logoImg}"alt="cover"/><p class="widget-des">${content||'没有获取到内容......'}</p></div><p class="author">by:${username||'没有获取到作者信息...'}</p><div class="readorups jumpPage"><span><img src="./img/read.svg"alt="read"/>${read || 0}</span><span><img src="./img/ups.svg"alt="ups"/>${ups || 0}</span></di></div></div>`;appDom.innerHTML=appDomStr;$clamp(document.querySelector('.widget-des'),{clamp:3});const titleClick=()=>{const jumpPageDom=document.querySelectorAll('.jumpPage');jumpPageDom.forEach((i,index)=>{jumpPageDom[index].addEventListener('click',()=>{const invite=urlSearchData.invite?`?invite=${urlSearchData.invite}`:'';window.open(`${url}/article/${urlSearchData.id||''}${invite}`)},false)})};titleClick()};const getArticleContent=(hash)=>{const url=`/ipfs/catJSON/${hash}`;axiosApi.get(url).then((res)=>{if(res.status===200&&res.data.code===200){const{data}=res.data;urlSearchData.content=regRemoveContent(data.content);const{title,content,img,ups,read,username,}=urlSearchData;setAppDom({title,content,img,ups,read,username,})}else{console.error('请求失败');setAppDom({})}}).catch((err)=>{console.log(err);setAppDom({})})};const getInfobyId=(id)=>{const url=`/p/${id}`;axiosApi.get(url).then((response)=>{if(response.status===200&&response.data.code===0){const{data}=response.data;urlSearchData.title=data.title;urlSearchData.ups=data.ups;urlSearchData.read=data.read;urlSearchData.username=data.nickname||data.username;urlSearchData.img=data.cover?`${baseUrl}/image/${data.cover}`:logoImg;const{title,content,img,ups,read,username,}=urlSearchData;setAppDom({title,content,img,ups,read,username,});if(!urlSearchData.content)getArticleContent(data.hash)}else{console.error('请求失败');setAppDom({})}}).catch((error)=>{console.log(error);setAppDom({})})};getInfobyId(urlSearchData.id)}());
