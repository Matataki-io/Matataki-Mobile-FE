"use strict";(function(){var urlSearch=window.location.search.substr(1).split('&');var appDom=document.querySelector('#app');var url="https://test.smartsignature.io";var baseUrl="https://apitest.smartsignature.io";var logoImg='../img/logo.png';var urlSearchData={};var axiosApi=axios.create({baseURL:baseUrl,timeout:30000});var regRemoveContent=function regRemoveContent(str){var strTrim=function strTrim(str){return str.replace(/\s+/g,'')};var regRemoveTag=function regRemoveTag(str){return str.replace(/<[^>]+>/ig,'')};var regRemoveMarkdownImg=function regRemoveMarkdownImg(str){return str.replace(/!\[.*?\]\((.*?)\)/ig,'')};var regRemoveMarkdownTag=function regRemoveMarkdownTag(str){return str.replace(/[\\\`\*\_\[\]\#\+\-\!\>]/ig,'')};var regRemoveTagResult=regRemoveTag(str);var regRemoveMarkdownImgResult=regRemoveMarkdownImg(regRemoveTagResult);var regRemoveMarkdownTagResult=regRemoveMarkdownTag(regRemoveMarkdownImgResult);return strTrim(regRemoveMarkdownTagResult)};var urlSearchDecodeURIComponent=function urlSearchDecodeURIComponent(arr){var data={};arr.forEach(function(i){var arrData=i.split('=');data[arrData[0]]=decodeURIComponent(arrData[1])});return data};urlSearchData=urlSearchDecodeURIComponent(urlSearch);if(urlSearchData.content)urlSearchData.content=regRemoveContent(urlSearchData.content);var setAppDom=function setAppDom(_ref){var title=_ref.title,content=_ref.content,img=_ref.img,ups=_ref.ups,read=_ref.read,username=_ref.username;var appDomStr="\n      <div class=\"container\">\n        <div class=\"widget\">\n          <img class=\"logo\" src=\"".concat(logoImg,"\" alt=\"logo\" />\n          <h1 class=\"jumpPage\">").concat(title||'没有获取到标题......',"</h1>\n          <div class=\"widget-content\">\n            <img class=\"cover jumpPage\" src=\"").concat(img||logoImg,"\" alt=\"cover\" />\n            <p class=\"widget-des\">").concat(content||'没有获取到内容......',"</p>\n          </div>\n          <p class=\"author\">by: ").concat(username||'没有获取到作者信息...',"</p>\n          <div class=\"readorups jumpPage\">\n            <span><img src=\"./img/read.svg\" alt=\"read\" />").concat(read||0,"</span>\n            <span><img src=\"./img/ups.svg\" alt=\"ups\" />").concat(ups||0,"</span>\n          </di>\n        </div>\n      </div>");appDom.innerHTML=appDomStr;$clamp(document.querySelector('.widget-des'),{clamp:4});var titleClick=function titleClick(){var jumpPageDom=document.querySelectorAll('.jumpPage');jumpPageDom.forEach(function(i,index){jumpPageDom[index].addEventListener('click',function(){window.open("".concat(url,"/article/").concat(urlSearchData.id||''))},false)})};titleClick()};var getArticleContent=function getArticleContent(hash){var url="/ipfs/catJSON/".concat(hash);axiosApi.get(url).then(function(res){if(res.status===200&&res.data.code===200){var data=res.data.data;urlSearchData.content=regRemoveContent(data.content);var _urlSearchData=urlSearchData,title=_urlSearchData.title,content=_urlSearchData.content,_urlSearchData$img=_urlSearchData.img,img=_urlSearchData$img===void 0?logoImg:_urlSearchData$img,ups=_urlSearchData.ups,read=_urlSearchData.read,username=_urlSearchData.username;setAppDom({title:title,content:content,img:img,ups:ups,read:read,username:username})}else{console.error('请求失败');setAppDom({})}}).catch(function(err){console.log(err);setAppDom({})})};var getInfobyId=function getInfobyId(id){var url="/p/".concat(id);axiosApi.get(url).then(function(response){if(response.status===200&&response.data.code===0){var data=response.data.data;urlSearchData.title=data.title;urlSearchData.ups=data.ups;urlSearchData.read=data.read;urlSearchData.username=data.nickname||data.username;var _urlSearchData2=urlSearchData,title=_urlSearchData2.title,content=_urlSearchData2.content,_urlSearchData2$img=_urlSearchData2.img,img=_urlSearchData2$img===void 0?logoImg:_urlSearchData2$img,ups=_urlSearchData2.ups,read=_urlSearchData2.read,username=_urlSearchData2.username;setAppDom({title:title,content:content,img:img,ups:ups,read:read,username:username});if(!urlSearchData.content)getArticleContent(data.hash)}else{console.error('请求失败');setAppDom({})}}).catch(function(error){console.log(error);setAppDom({})})};getInfobyId(urlSearchData.id)})();